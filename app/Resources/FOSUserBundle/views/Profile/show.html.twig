{% extends "@FOSUser/layout.html.twig" %}

{% trans_default_domain 'FOSUserBundle' %}

{% block fos_user_content %}

    <div class="container fos_user_user_show">

        <div class="col-lg-12 col-sm-12">
            <div class="card hovercard">
                <div class="card-background">
                    <img class="card-bkimg" alt="" src="#">
                </div>
                <div class="useravatar">
                    {% if user.picture %}
                        <img alt="{{ user.name }}" src="{{ asset('uploads/' ~ user.picture.name) }}">
                    {% endif %}
                </div>
                <div class="card-info"><span class="card-title">{{ user.firstname }} {{ user.name }}</span>

                </div>
            </div>
            <div class="btn-pref btn-group btn-group-justified btn-group-lg" role="group" aria-label="...">
                <div class="btn-group" role="group">
                    <button type="button" id="stars" class="btn btn-primary" href="#tab1" data-toggle="tab"><span
                                class="glyphicon glyphicon-star" aria-hidden="true"></span>
                        <div class="hidden-xs">MON PROFIL</div>
                    </button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" id="favorites" class="btn btn-default" href="#tab2" data-toggle="tab"><span
                                class="glyphicon glyphicon-heart" aria-hidden="true"></span>
                        <div class="hidden-xs">MES ANNONCES</div>
                    </button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" id="favorites" class="btn btn-default" href="#tab3" data-toggle="tab"><span
                                class="glyphicon glyphicon-heart" aria-hidden="true"></span>
                        <div class="hidden-xs">MES RÉSERVATIONS</div>
                    </button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" id="following" class="btn btn-default" href="#tab4" data-toggle="tab"><span
                                class="glyphicon glyphicon-user" aria-hidden="true"></span>
                        <div class="hidden-xs">MA MESSAGERIE</div>
                    </button>
                </div>
            </div>

            <div class="well">
                <div class="tab-content">
                    <div class="tab-pane fade in active" id="tab1">
                        <h3>Voir et modifier mon profil</h3>
                        <p><span class="bold">PRÉNOM :</span> {{ user.firstname }}</p>
                        <p><span class="bold">NOM :</span> {{ user.name }}</p>
                        <p><span class="bold">EMAIL :</span> {{ user.email }}</p>
                        <p><span class="bold">TÉLÉPHONE :</span> {{ user.phone }}</p>
                        <p><span class="bold">DESCRIPTION :</span> {{ user.description }}</p>
                        <a href="{{ path('fos_user_profile_edit') }}">
                            <button class="btn btn-primary">Modifier mon profil</button>
                        </a>
                    </div>
                    {#TODO: Edit style for heigth tab#}
                    <div class="tab-pane fade in" id="tab2">
                        <h3>Mes annonces</h3>
                        {% if user.adverts is defined %}
                            {% for advert in user.adverts %}
                                <div class="col-md-4 col-xs-12">
                                    <div class="thumbnail">
                                        <a href="{{ path('advert_show', { 'id': advert.id }) }}">

                                            <div id="{{ advert.id }}" class="carousel slide" data-ride="carousel" data-interval="false">

                                                <ol class="carousel-indicators">
                                                    {%  set isFirst = true %}
                                                    {% for picture in advert.pictures  %}
                                                        {% if isFirst == true %}
                                                            <li data-target="#{{ advert.id }}" data-slide-to="{{ loop.index0 }}" class="active"></li>
                                                        {% else %}
                                                            <li data-target="#{{ advert.id }}" data-slide-to="{{ loop.index0 }}"></li>
                                                        {% endif %}

                                                        {% set isFirst = false %}
                                                    {% endfor %}
                                                </ol>
                                                <div id="carousel_results" class="carousel-inner" role="listbox">
                                                    {%  set isFirst = true %}
                                                    {% for picture  in advert.pictures  %}
                                                    {% if isFirst == true %}
                                                    <div class="item active">
                                                        {% else %}
                                                        <div class="item">

                                                            {% endif %}
                                                            <img src="{{ app.request.basepath }}/uploads/{{ picture.name }}" alt="{{ advert.title }}" class="crush-img">
                                                        </div>
                                                        {% set isFirst = false %}
                                                        {% endfor %}
                                                    </div>
                                                    <a class="left carousel-control" href="#{{ advert.id }}" role="button" data-slide="prev">
                                                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                                                        <span class="sr-only">Previous</span>
                                                    </a>
                                                    <a class="right carousel-control" href="#{{ advert.id }}" role="button" data-slide="next">
                                                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                                                        <span class="sr-only">Next</span>
                                                    </a>

                                                </div>

                                        </a>
                                        {#<img src="{{ advert.picture }}">#}
                                        <div class="caption">
                                            <h4>{{ advert.title }}</h4>
                                            <p class="type">{{ advert.type }}</p>
                                            <p>{{ advert.price }}€/heure</p>
                                            <p class="text-right">{{ advert.zipcode }} {{ advert.city }}</p>
                                            <div class="row text-center">
                                                <a href="{{ path('advert_edit', {'id': advert.id}) }}" class="btn btn-primary btn-lg">Modifier</a>
                                                <a href="{{ path('advert_show', {'id': advert.id}) }}" class="btn btn-primary btn-lg">Détail</a>
                                            </div>

                                            {#{{ advert.rate }}</p>#}
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <p>Vous n'avez pas d'annonce</p>
                        {% endif %}
                    </div>

                    <div class="tab-pane fade in" id="tab3">
                        {% if user.reservations is defined %}
                            {% for reservation in user.reservations %}
                                {{ dump(reservation) }}
                            {% endfor %}
                        {% else %}
                            <p>Vous n'avez pas d'annonce</p>
                        {% endif %}
                    </div>

                    <div class="tab-pane fade in" id="tab4">
                        <h3>Mes messages</h3>
                    </div>
                </div>
            </div>

        </div>

    </div>

{% endblock fos_user_content %}

{% block javascripts %}

    <script>
        $(document).ready(function () {
            $(".btn-pref .btn").click(function () {
                $(".btn-pref .btn").removeClass("btn-primary").addClass("btn-default");
                // $(".tab").addClass("active"); // instead of this do the below
                $(this).removeClass("btn-default").addClass("btn-primary");
            });
        });
    </script>

{% endblock %}
